<!doctype html>
<html lang="en" class="h-100">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Tan Yong Xiang">
  <meta name="generator" content="Hugo 0.108.0">

  <title>PhpOfficeTemplate</title>

  <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/cover/">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" />

  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer" />

  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&amp;display=fallback">

  <!-- <link rel="stylesheet" href="../lib/EnhanceDataGrid/src/EnhanceDataGrid.min.css" /> -->
  <link rel="stylesheet" href="index.css" />

  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }

    .b-example-divider {
      height: 3rem;
      background-color: rgba(0, 0, 0, .1);
      border: solid rgba(0, 0, 0, .15);
      border-width: 1px 0;
      box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
    }

    .b-example-vr {
      flex-shrink: 0;
      width: 1.5rem;
      height: 100vh;
    }

    .bi {
      vertical-align: -.125em;
      fill: currentColor;
    }

    .nav-scroller {
      position: relative;
      z-index: 2;
      height: 2.75rem;
      overflow-y: hidden;
    }

    .nav-scroller .nav {
      display: flex;
      flex-wrap: nowrap;
      padding-bottom: 1rem;
      margin-top: -1px;
      overflow-x: auto;
      text-align: center;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }

    #nav-dependencies {
      font-family: "Source Sans Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
    }
  </style>
</head>

<body class="d-flex h-100 text-center text-bg-dark d-flex flex-column">
  <div class="cover-container d-flex w-100 h-100 p-3 _mx-auto flex-column">
    <header class="mb-3">
      <div>
        <h3 class="float-md-start mb-0">PhpOfficeTemplate</h3>
        <nav>
          <div class="nav nav-masthead justify-content-center float-md-end" id="nav-tab" role="tablist">
            <a class="nav-link fw-bold py-1 px-0 active" href="#home" id="nav-home-tab" data-bs-toggle="tab"
              data-bs-target="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Home</a>

            <a class="nav-link fw-bold py-1 px-0" href="#dependencies" id="nav-dependencies-tab" data-bs-toggle="tab"
              data-bs-target="#nav-dependencies" role="tab" aria-controls="nav-dependencies" aria-selected="false">Dependencies</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="flex-fill">
      <div class="tab-content h-100" id="nav-tabContent">
        <div class="tab-pane fade h-100 show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab" tabindex="0">
          <div class="d-flex flex-row h-100">

            <div class="rounded flex-fill overflow-hidden position-relative w-75">
              <form id="form_template_result" method="post" target="iframe_template_preview" action="template-output.php">
                <input type="hidden" name="filename" />
                <input type="hidden" name="fileprefix" />
                <input type="hidden" name="targetdir" />
              </form>

              <iframe id="iframe_template_preview" name="iframe_template_preview" class="bg-secondary w-100 h-100"></iframe>

              <div id="loading" class="position-absolute top-0 bottom-0 start-0 end-0 bg-light bg-opacity-50"
                style="display: none;">
                <div class="d-flex flex-column h-100">
                  <div class="mb-auto"></div>

                  <div>
                    <h4 class="d-flex align-items-center justify-content-center">
                      <div class="spinner-grow spinner-grow-sm text-warning me-3" role="status">
                        <span class="visually-hidden">Processing Template</span>
                      </div>
                      <span class="text-danger">Processing Template</span>
                    </h4>

                    <p class="text-bg-dark fw-bold">Please wait patiently while system is generating the template result ...</p>
                  </div>

                  <div class="mt-auto"></div>
                </div>
              </div>
            </div>

            <div class="p-1 ms-3 bg-white rounded">
              <form id="form_template_upload" method="post" target="iframe_template_preview" action="template-output.php" enctype="multipart/form-data">

                <div class="row">
                  <div class="col-sm-12">
                    <input type="hidden" name="targetdir" />
                    <input type="file" id="formFile" name="upload_file" class="form-control" />
                  </div>
                </div>

                <div class="row mt-1">
                  <label class="col-sm-6 col-form-label-sm text-secondary text-end">
                    Open In
                    <a tabindex="0"
                      data-bs-toggle="popover"
                      data-bs-trigger="hover focus"
                      data-bs-placement="bottom"
                      data-bs-title="Open In"
                      data-bs-content="Output result in 'Template Preview' or 'New Window Tab'">
                      <i class="fa-solid fa-circle-question text-primary fs-6"></i>
                    </a>
                  </label>

                  <div class="col-sm-6 btn-group btn-group-sm" role="group" aria-label="Basic radio toggle button group">
                    <input type="radio" class="btn-check" name="openIn" id="openIn1" autocomplete="off" checked>
                    <label class="btn btn-outline-danger" for="openIn1">Preview</label>

                    <input type="radio" class="btn-check" name="openIn" id="openIn2" autocomplete="off">
                    <label class="btn btn-outline-danger" for="openIn2">New Tab</label>
                  </div>
                </div>

                <div class="row mt-1">
                  <label class="col-sm-6 col-form-label-sm text-secondary text-end">
                    Display
                    <a tabindex="0"
                      data-bs-toggle="popover"
                      data-bs-trigger="hover focus"
                      data-bs-placement="bottom"
                      data-bs-title="Display"
                      data-bs-content="'Upload' will upload template into specified folder and then process the uploaded template for output result">
                      <i class="fa-solid fa-circle-question text-primary fs-6"></i>
                    </a>
                  </label>

                  <div class="col-sm-6 btn-group btn-group-sm" role="group" aria-label="Basic radio toggle button group">
                    <input type="radio" class="btn-check" name="display" id="display1" autocomplete="off" checked>
                    <label class="btn btn-outline-danger" for="display1">Direct</label>

                    <input type="radio" class="btn-check" name="display" id="display2" autocomplete="off">
                    <label class="btn btn-outline-danger" for="display2">Upload</label>
                  </div>
                </div>

                <div class="row mt-1">
                  <label class="col-sm-6 col-form-label-sm text-secondary text-end">
                    Output Method
                    <a tabindex="0"
                      data-bs-toggle="popover"
                      data-bs-trigger="hover focus"
                      data-bs-placement="bottom"
                      data-bs-title="Output Method"
                      data-bs-content="Output result method">
                      <i class="fa-solid fa-circle-question text-primary fs-6"></i>
                    </a>
                  </label>

                  <div class="col-sm-6">
                    <select name="output_option" class="form-select form-select-sm" aria-label="Default select example">
                      <option value="browser" selected>Browser</option>
                      <option value="download">Download</option>
                      <option value="server">Save in Server</option>
                    </select>
                  </div>
                </div>

                <div class="row mt-1">
                  <label class="col-sm-6 col-form-label-sm text-secondary text-end">
                    Download As
                    <a tabindex="0"
                      data-bs-toggle="popover"
                      data-bs-trigger="hover focus"
                      data-bs-placement="bottom"
                      data-bs-title="Download As"
                      data-bs-content="ONLY works when output method is 'Download'">
                      <i class="fa-solid fa-circle-question text-primary fs-6"></i>
                    </a>
                  </label>

                  <div class="col-sm-6">
                    <select name="download_option" class="form-select form-select-sm" aria-label="Default select example">
                      <option value="pdf" selected>pdf</option>
                      <option value="xlsx">xlsx</option>
                      <option value="xls">xls</option>
                      <option value="ods" class="d-none">ods</option>
                      <option value="docx">docx</option>
                      <option value="doc">doc</option>
                      <option value="odt" class="d-none">odt</option>
                    </select>
                  </div>
                </div>

                <div class="row mt-1">
                  <label class="col-sm-6 col-form-label-sm text-secondary text-end">
                    Orientation
                    <a tabindex="0"
                      data-bs-toggle="popover"
                      data-bs-trigger="hover focus"
                      data-bs-placement="bottom"
                      data-bs-title="Orientation"
                      data-bs-content="'Default' will follow page original orientation">
                      <i class="fa-solid fa-circle-question text-primary fs-6"></i>
                    </a>
                  </label>

                  <div class="col-sm-6">
                    <select name="orientation_option" class="form-select form-select-sm" aria-label="Default select example">
                      <option value="default" selected>default</option>
                      <option value="portriat">Portriat</option>
                      <option value="landscape">Landscape</option>
                    </select>
                  </div>
                </div>

              </form>
            </div>

          </div>
        </div>

        <div class="tab-pane fade h-100" id="nav-dependencies" role="tabpanel" aria-labelledby="nav-dependencies-tab" tabindex="0">
          <div class="p-3 h-100 rounded text-bg-light text-start" style="background-color: #f4f6f9;">
            <h4>Dependencies</h4>
            <p class="lead">PhpOfficeTemplate depends on following main libraries. Please install all of them through using <a class="text-decoration-none" target="_blank" href="https://getcomposer.org/">composer</a>.</p>
            <ul>
              <li><a class="link-primary text-decoration-none" target="_blank" href="https://github.com/PHPOffice/PhpSpreadsheet">PhpSpreadsheet 1.25+</a></li>
              <li><a class="link-primary text-decoration-none" target="_blank" href="https://github.com/PHPOffice/PHPWord">PHPWord 1.0+</a></li>
              <li><a class="link-primary text-decoration-none" target="_blank" href="https://github.com/mpdf/mpdf/">mPDF 8.1+</a></li>
              <li><a class="link-primary text-decoration-none" target="_blank" href="https://github.com/tecnickcom/TCPDF/">TCPDF 6.+6</a></li>
              <li><a class="link-primary text-decoration-none" target="_blank" href="https://github.com/dompdf/dompdf">Dompdf 2.0+</a></li>
              <li><a class="link-primary text-decoration-none" target="_blank" href="https://github.com/ncjoes/office-converter">Office Converter 1.0</a></li>
            </ul>
            <pre class="text-bg-secondary p-2 rounded-1"><code><i>#</i> composer install</code></pre>
          </div>
        </div>
      </div>

    </main>

    <footer class="mt-3 text-white-50">
      <!-- <p>Cover template for <a href="https://getbootstrap.com/" class="text-white">Bootstrap</a>, by <a href="https://twitter.com/mdo" class="text-white">@mdo</a>.</p> -->
      <span class="ms-auto link-light">Copyright &copy; 2022 <a class="link-light text-decoration-none" target="_blank" href="https://www.rightpristine.com/zeikman/">Zeikman</a>. All Rights Reserved.</span>
    </footer>
  </div>

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
  <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script> -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script> -->
  <!-- <script type="text/javascript" src="../lib/EnhanceDataGrid/src/EnhanceDataGrid.min.js"></script> -->

  <script>
    const POT = {
      show_loading: function(callback) {
        callback
          ? $('#loading').fadeIn(400, callback)
          : $('#loading').fadeIn();
      },
      hide_loading: function(callback) {
        callback
          ? $('#loading').fadeOut(400, callback)
          : $('#loading').fadeOut();
      },
      upload_template: function(e) {
        const id = e.target.id;
        const fileinput = document.getElementById(id);
        const files = fileinput.files;
        let file;

        // console.log(e)
        // console.log(this)
        // console.log(this.value)
        // console.log(files)

        if (files.length > 0) { // only one file at a time
          file = files[0];
        } else {
          return;
        }

        POT.show_loading(function() {
          // setTimeout(() => {
          //   POT.hide_loading(function() {
          //     $('#formFile').val('');
          //   });
          // }, 2000);
          // return;

          const reader = new FileReader();

          reader.readAsText(file, "UTF-8");

          reader.onload = function (e) {
            const isDirectDisplay = $('#display1').prop('checked');
            const upload_path = 'uploaded_template/';

            // process uploaded document directly
            if (isDirectDisplay) {
              $('#form_template_upload').find('input[name=targetdir]').val(upload_path);

              $('#form_template_upload').submit();

              $('#formFile').val('');
            }
            // upload document to server, then process uploaded template
            else {
              const fd  = new FormData();
              const xhr = new XMLHttpRequest();

              xhr.open('POST', 'template-upload.php', true);

              xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                  // console.log('present result');

                  // $('#iframe_template_preview').attr('src', 'test.pdf');

                  // can update value dynamically depends on your needs
                  $('#form_template_result').find('input[name=filename]').val(file['name']);
                  $('#form_template_result').find('input[name=fileprefix]').val('MyTemplate');
                  $('#form_template_result').find('input[name=targetdir]').val(upload_path);

                  $('#form_template_result').submit();
                }

                $('#formFile').val('');
              };

              fd.append('upload_file', file);
              fd.append('targetdir', upload_path);

              xhr.send(fd);
            }
          }

          reader.onerror = function (err) {
            console.log(err)
            console.log(err.target.error)

            POT.hide_loading();
          };
        });
      },
    };

    $(document).ready(function () {
      //*/
      // NOTE: test loading() / hide_loading()
      POT.show_loading(function() {
        $('#iframe_template_preview').attr('src', 'form-template-preview.html');

        // setTimeout(() => {
        //   POT.hide_loading();

        //   setTimeout(() => {
        //     POT.show_loading(function () {
        //       $('#iframe_template_preview').attr('src', 'test.pdf');

        //       setTimeout(() => {
        //         POT.hide_loading();
        //       }, 1000);
        //     });
        //   }, 3000);
        // }, 1000);
      });
      //*/

      $('#formFile').on('change', POT.upload_template);

      $('#iframe_template_preview').on('load', function (e) {
        setTimeout(() => {
          POT.hide_loading();
        }, 1000);
      });

      const form_template_upload = $('#form_template_upload')

      $('#openIn1').on('change', function(e) {
        if (e.target.checked)
          form_template_upload.attr('target', 'iframe_template_preview');
      });

      $('#openIn2').on('change', function(e) {
        if (e.target.checked)
          form_template_upload.attr('target', '_blank');
      });

      // Init Popover
      const popoverTriggerList = document.querySelectorAll('[data-bs-toggle="popover"]');
      const popoverList = [...popoverTriggerList].map(popoverTriggerEl => new bootstrap.Popover(popoverTriggerEl));

      // $('#nav-dependencies-tab').trigger('click');
      document.getElementById("nav-dependencies-tab").click();

      // const triggerEl = document.querySelector('#nav-tab a[data-bs-target="#nav-dependencies"]');
      // // const triggerEl = document.querySelector('#nav-dependencies-tab');
      // console.log(triggerEl)
      // console.log(bootstrap.Tab.getInstance(triggerEl))
      // // bootstrap.Tab.getInstance(triggerEl).show() // Select tab by name
    });
  </script>
</body>

</html>